!function(e,t){function i(t){var i,s=[];return e.each(t,function(){i=e(this),s.push({value:i.val(),text:i.text().trim()})}),s}e.fn.fuzzyDropdown=function(s){function n(){y.children("."+r.selectedClass).removeClass(r.selectedClass)}var l,a,o,r=e.extend({enableBrowserDefaultScroll:!1},s),d=e(this),c=e(r.mainContainer),h=e(c.children("div")[0]),u=h.children("span:first"),v=e(h.children("span")[1]),f=e(c.children("div")[1]),p=f.children("input:first"),y=f.children("ul:first"),g=d.children("option"),C=i(g),k=+new Date+"-no-results-found",m=new t(C,{keys:["text"],id:"value",location:r.location||0,threshold:r.threshold||.61,distance:r.distance||100,maxPatternLength:r.maxPatternLength||64,caseSensitive:r.caseSensitive||!1,includeScore:r.includeScore||!1,shouldSort:r.shouldSort||!0});if(d.children("option").length){console.debug("fuzzyDropdown: threshold is "+r.threshold),d.hide(),e(r.mainContainer+":hidden").length&&c.show(),l=d.children("option[selected]"),l=l.length?l:d.children("option:first"),u.attr("data-val",l.val()),u.text(l.text());for(var b=0;b<g.length;b++)o='<li data-val="'+g[b].value+'">'+g[b].text+"</li>",y.append(o);var w=Parse.Object.extend("Patients"),x=new Parse.Query(w);x.equalTo("pharmacyId",Parse.User.current().id),x.find({success:function(e){for(var t=0;t<e.length;t++){var i=e[t].get("name"),s=e[t].id,n=(e[t].createdAt,e[t].updatedAt,e[t].get("email"),e[t].get("address")),l=e[t].get("telephone"),a='<li data-val="'+s+'"> '+i+" "+n+" "+l+s+"</li>";y.append(a)}},error:function(e){alert("Error: "+e.code+" "+e.message)}}),y.append('<li id="'+k+'" style="display:none;">No patients found from your search, either refine search or enter patient info into the form and submit.</li>'),a=y.children("li"),p.keyup(function(){var t,i=e(this),s=i.val();""===s?(a.css("display","list-item"),e("#"+k).css("display","none")):(t=m.search(s),t.length?(a.css("display","none"),a.each(function(){for(var i=e(this),s=0;s<t.length;s++)i.attr("data-val")===""+t[s]&&i.css("display","list-item")})):(a.css("display","none"),e("#"+k).css("display","list-item")))}),h.click(function(e){e.preventDefault(),e.stopPropagation(),v.toggleClass(r.arrowUpClass),f.slideToggle(100),f.is(":visible")&&p.focus().select(),n()}),f.on("click","li",function(){var t=e(this);u.attr("data-val",t.attr("data-val")),u.text(t.text()),d.find("option:selected").prop("selected",!1),d.children("option[value="+t.attr("data-val")+"]").prop("selected",!0).change()}),e("body").click(function(){f.is(":visible")&&!p.is(":focus")&&h.click()}),p.keydown(function(t){return t.stopPropagation(),n(),y.children(":visible:first").get(0)===e("#"+k).get(0)?void n():void(40===t.keyCode&&(y.children(":visible:first").addClass(r.selectedClass),p.blur()))}),y.on("keydown","li",function(t){var i=e(this),s=y.children(":visible:first").get(0)===i.get(0),n=y.children(":visible:last").get(0)===i.get(0),l=i.next(),a=i.prev();if(t.preventDefault(),t.stopPropagation(),s&&38===t.keyCode)return i.removeClass(r.selectedClass),void p.focus().select();if(!n||40!==t.keyCode){if(40===t.keyCode){for(i.removeClass(r.selectedClass);!l.is(":visible");)l=l.next();return void l.addClass(r.selectedClass)}if(38===t.keyCode){for(i.removeClass(r.selectedClass);!a.is(":visible");)a=a.prev();return void a.addClass(r.selectedClass)}13===t.keyCode&&i.click()}}),e("body").on("keydown",function(t){var i;!f.is(":visible")||38!==t.keyCode&&40!==t.keyCode&&13!==t.keyCode||(r.enableBrowserDefaultScroll||t.preventDefault(),t.stopPropagation(),i=e.Event("keydown"),i.keyCode=t.keyCode,y.children("."+r.selectedClass).trigger(i))})}}}(window.jQuery,window.Fuse);